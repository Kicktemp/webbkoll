<p><%= gettext(~s|HSTS policy for https://%{host}: <code>%{value}</code>.|, host: @host, value: safe_to_string(html_escape(@hsts.data))) |> raw %></p>

<table class="hsts data">
  <thead>
    <tr>
      <th class="test"><%= gettext "Test" %></th>
      <th class="pass"><%= gettext "Pass" %></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <code>max-age</code> set to at least 6 months
      </td>
      <td>
        <%= if @hsts.pass do %>
        <%= icon(:pass) %>
        <% else %>
        <%= icon(:fail) %>
        <% end %>
      </td>
    </tr>
    <tr>
      <td>
        <code>includeSubDomains</code> &mdash; policy also applies to subdomains
      </td>
      <td>
        <%= if @hsts.includesubdomains do %>
        <%= icon(:pass) %>
        <% else %>
        <%= icon(:fail) %>
        <% end %>
      </td>
    </tr>
    <tr>
      <td>
        <code>preload</code> - requests inclusion in preload lists
        <%= if not @is_base do %>
          [only relevant for base domain]
        <% end %>
      </td>
      <td>
        <%= if @is_base do %>
          <%= if @hsts.preload do %>
          <%= icon(:pass) %>
          <% else %>
          <%= icon(:fail) %>
          <% end %>
        <% else %>
          <%= icon(:optional) %>
        <% end %>
      </td>
    </tr>
  </tbody>
</table>
